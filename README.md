# SimpleQRReader (Google Apps Script版)

ウェブカメラを使用してQRコード（識別番号）を読み取り、関連するデータをGoogleスプレッドシートに記録・更新するウェブアプリケーションです。

## 機能

*   **QRコードスキャン:** デバイスのカメラを使用してQRコードをスキャンし、識別番号を読み取ります。
*   **データ入力:** スキャン後、ウェブアプリ上のテキストボックスに関連データを入力できます。
*   **スプレッドシート更新:**
    *   読み取った識別番号を「一覧」シートのA列で検索します。
    *   一致する行が見つかった場合、その行のD列にテキストボックスの入力値（空の場合は`TRUE`）を書き込みます。
*   **ログ記録:**
    *   データ更新の試行（成功・失敗問わず）を「ログ」シートに記録します。
    *   記録内容: タイムスタンプ、スキャンされた識別番号、入力値。
*   **スプレッドシートメニュー:**
    *   **QRコードリーダー設定:** ウェブアプリがデータを書き込むスプレッドシートのIDを設定します（初回必須）。
    *   **QRコード作成 (一覧シート):** 「一覧」シートのA列の識別番号に基づいて、C列にQRコード画像を生成します（`=IMAGE(...)`関数を使用）。

## 必要なもの

*   Googleアカウント
*   Googleスプレッドシート
    *   `一覧` という名前のシート
        *   A列: 識別番号 (QRコードの内容と一致)
        *   (B列: 名称 - オプション)
        *   (C列: QRコード - メニューから生成可能)
        *   D列: ウェブアプリからの入力値が書き込まれる列
    *   `ログ` という名前のシート
        *   A列: タイムスタンプ
        *   B列: スキャンされた識別番号
        *   C列: ウェブアプリからの入力値

## 使い方

1.  **スプレッドシートの準備:** 上記「必要なもの」セクションに従って、Googleスプレッドシートと必要なシート（`一覧`, `ログ`）を作成します。「一覧」シートのA列に識別番号を入力しておきます。
2.  **Google Apps Scriptプロジェクトの作成:**
    *   スプレッドシートを開き、「拡張機能」 > 「Apps Script」を選択します。
    *   エディタが開いたら、このリポジトリにある3つのファイル (`appsscript.json`, `code.js`, `index.html`) の内容を、それぞれApps Scriptエディタ内の同名のファイルにコピー＆ペーストします（ファイルが存在しない場合は新規作成）。
3.  **スプレッドシートIDの設定:**
    *   Apps Scriptエディタからスプレッドシートに戻ります。
    *   ページを再読み込みすると、「QRコードツール」というカスタムメニューが表示されます。
    *   「QRコードツール」 > 「QRコードリーダー設定」を選択し、プロンプトに従って現在のスプレッドシートのIDを入力します。（スプレッドシートのURL `https://docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit` の `SPREADSHEET_ID` の部分です）。
4.  **(任意) QRコードの生成:**
    *   「QRコードツール」 > 「QRコード作成 (一覧シート)」を選択すると、「一覧」シートのC列にA列の識別番号に対応するQRコードが表示されます。
5.  **ウェブアプリのデプロイ:**
    *   Apps Scriptエディタに戻り、「デプロイ」 > 「新しいデプロイ」を選択します。
    *   種類の選択（歯車アイコン）で「ウェブアプリ」を選択します。
    *   設定で以下のように構成します:
        *   説明: (任意) Simple QR Reader など
        *   次のユーザーとして実行: **自分**
        *   アクセスできるユーザー: **全員** （または組織内のユーザーなど、利用者に合わせて設定）
    *   「デプロイ」ボタンをクリックします。初回デプロイ時には承認を求められるので、許可してください。
6.  **ウェブアプリの利用:**
    *   デプロイ後に表示されるウェブアプリのURLにアクセスします。
    *   ブラウザでカメラへのアクセス許可を求められたら、許可します。
    *   「一覧」シートのA列に対応するQRコードをスキャンします。
    *   識別番号が表示されたら、テキストボックスに値を入力（または空欄のまま）し、「データ更新」ボタンを押します。
    *   結果メッセージが表示され、スプレッドシートの「一覧」シートD列と「ログ」シートが更新されます。
